<ng-template #loading>
  Loading stuff...
</ng-template>

<div class="freecell-container" *ngIf="breakpoints$ | async as bs" >
  <!-- Sidenav Container -->
  <mat-sidenav-container class="freecell-sidenav-container">
    <!-- Sidenav Drawer -->
    <mat-sidenav
      [mode]="(!settings.sidenavModeSide || bs.breakpoints[BP_XS]) ? 'over' : 'side'"
      [opened]="!settings.sidenavClosed"
      (closedStart)="settings.sidenavClosed=true"
      (openedChange)="sidenavOpened=$event"
    >
      <mat-toolbar color="primary" class="freecell-toolbar">
        <button mat-icon-button (click)="settings.sidenavClosed=true">
          <mat-icon>close</mat-icon>
        </button>
        <span class="flex-space-filler-1"></span>
        <span>Freecell</span>
        <span class="flex-space-filler-1"></span>
        <mat-slide-toggle *ngIf="!bs.breakpoints[BP_XS]" color="primary"
          [checked]="settings.sidenavModeSide"
          (change)="settings.sidenavModeSide=$event.checked"
        ></mat-slide-toggle>
      </mat-toolbar>
      <mat-action-list>
        <app-freecell-deal-menu [listItem]="true"></app-freecell-deal-menu>
        <div mat-subheader>Actions:</div>
        <button mat-list-item
          [disabled]="!actionService.canUndo"
          (click)="actionService.undo()"
        >
          <mat-icon color="primary">undo</mat-icon>
          UNDO
        </button>
        <button mat-list-item
          [disabled]="!actionService.canRedo"
          (click)="actionService.redo()"
        >
          <mat-icon color="primary">redo</mat-icon>
          REDO
        </button>
        <button mat-list-item
          [disabled]="!actionService.nextMove"
          (click)="actionService.playNext()"
        >
          <mat-icon color="accent">emoji_objects</mat-icon>
          <span>AUTO</span>
        </button>
      </mat-action-list>
      <div style="padding: 1em;">
        <app-freecell-history></app-freecell-history>
      </div>
      <span class="flex-space-filler-1"></span>
      <mat-divider></mat-divider>
      <mat-action-list>
        <button mat-list-item (click)="settingsChange.emit()">
          <mat-icon>settings</mat-icon>
          <span>SETTINGS</span>
        </button>
      </mat-action-list>

      <!-- <mat-accordion>
        <mat-expansion-panel>
          <mat-expansion-panel-header>
            <mat-panel-title>
              Settings
            </mat-panel-title>
            <mat-panel-description>
              <mat-icon>settings</mat-icon>
            </mat-panel-description>
          </mat-expansion-panel-header>
          <mat-nav-list>
            <a mat-list-item routerLink="/freecell-sandwich" queryParamsHandling="preserve">
              <mat-icon>view_day</mat-icon>
              <span>Toggle view</span>
            </a>
          </mat-nav-list>

          <mat-slider [min]="0.40" [max]="0.75"  [step]="0.01" [(ngModel)]="aspectRatio"></mat-slider>


            <mat-label>Aspect ratio</mat-label>
            <input matInput type="number" [min]="0.40" [max]="0.75"  [step]="0.01" [(ngModel)]="aspectRatio">
        </mat-expansion-panel>
      </mat-accordion> -->

    </mat-sidenav>

    <!-- Sidenav Content -->
    <mat-sidenav-content>
      <app-freecell-main>
        <button
          *ngIf="settings.sidenavClosed"
          class="sidenav-open-button"
          [class.sidenav-open-button-active]="!sidenavOpened"
          mat-icon-button color="primary"
          (click)="settings.sidenavClosed=false"
        >
          <mat-icon>double_arrow</mat-icon>
        </button>
      </app-freecell-main>

    </mat-sidenav-content>
  </mat-sidenav-container>
</div>
